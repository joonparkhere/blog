---
title: 라즈베리파이 4B HDD 설정하기
date: 2020-02-17
pin: false
tags:
- Raspberry Pi
- NAS
---

라즈베리파이 4로 NAS 구축하기 2편, HDD 세팅입니다.

# OMV HDD 세팅

저는 NAS 스토리지 용으로 예전 블랙 프라이데이때 구매를 해놓았던 WD 2TB Red 3.5` HDD를 활용하기로 했습니다.

아쉽게도 라즈베리파이 4B 기본 구성에서는 SATA 연결을 지원하지 않아서 USB 3.0 포트로 HDD를 연결해야합니다. 다만 3.5인치이니 만큼 별도의 파워 공급이 필요하고 안정적으로 구동시키기 위해 도킹스테이션을 별도로 구매해서 사용 중입니다.



### OMV 디스크 포맷

HDD를 연결하고 조금 기다리면 OMV Web 좌측의 `저장소` - `디스크` 탭에서에서 확인할 수 있습니다.

![](./images/hdd_format.png)

기존에 다른 용도로 사용 중이었던 HDD이었다면 상단의 `지우기` 버튼으로 초기화를 해야합니다. (혹시 모를 경우를 대비해 새 HDD인 경우에도 초기화하는 것을 권장합니다.)

초기화할 때 `보안`과 `빠르게` 두 가지 옵션을 선택할 수 있는데, 필요에 맞게 선택하시면 됩니다.

저는 이전 HDD에서 불량 섹터가 검출된 적이 있어서 안전하게 `보안`을 선택했습니다. 2TB 포맷하는 데 대략 5시간정도가 걸린 것 같습니다..



### HDD 마운트

HDD 사용 준비가 되었다면 `저장소` - `파일 시스템` 탭에서 등록할 수 있습니다.

초기에는 `boot`, `rootfs` 레이블 장치들만 조회가 될텐데, 상단의 `생성` 버튼을 눌러서 HDD를 추가해줍니다.

이때 레이블은 해당 HDD를 식별할 수 있는 정보로 저와 같이 `hdd1`으로 정하셔도 됩니다. 그리고 파일 구조는 리눅스 기반의 OS를 사용하는 만큼 `EXT4`를 선택해주시면 됩니다.

<img src="./images/hdd_file_format.png" style="zoom:80%;" />

`확인` 버튼을 누르면 해당 형식으로 변환하는 작업을 진행합니다. 2TB 기준 대략 5분정도 걸린 것 같습니다. 아래의 사진처럼 안내 문구가 뜨면 정상적으로 HDD 추가를 완료한 것입니다.

<img src="./images/hdd_adding.png" style="zoom: 80%;" />

아마 자동으로 마운트가 될테지만, 그렇지 않다면 상단의 `마운트` 버튼을 눌러서 HDD를 사용할 수 있습니다.

이후 HDD 관리에 각별히 유의하셔야 합니다. 억지로 연결을 끊거나 마음대로 강제 종료하는 등의 행동은 되도록이면 피하셔야 합니다. 하드웨어는 망가지면 고치기가 매우매우 힘들기 때문에 더더욱 조심하셔야 합니다. (HDD 2개를 망가뜨려 RMA를 보낸 후, 깊이 깨달은 점입니다..ㅠ)



### 접근 권한 설정

대부분의 OS에서 그렇듯이, 디렉토리 혹은 파일에 대한 접근 권한은 계정 별로 상이하게 설정됩니다.



##### 공유 폴더

계정 설정 전, 각 계정마다의 홈 디렉터리를 설정하기 위해 먼저 `접근 권한 관리` - `공유 폴더` 탭에 들어가 보겠습니다. 상단의 `추가` 버튼을 눌러서 아래처럼 홈 디렉터리 용도의 폴더를 추가합니다.

<img src="./images/share_folder.png" style="zoom:80%;" />

`이름`은 용도에 맞게 설정하고, `장치`는 앞서 마운트한 HDD를 선택합니다. `경로`는 HDD의 최상단 경로 기준의 상대 경로로, 이 또한 용도에 맞게 설정합니다. 지금은 사용자 별 홈 디렉터리를 공유하는 것이므로 최상단에 `home/` 디렉터리를 사용하도록 설정했습니다.



##### 사용자 권한

사용자 목록은 `접근 권한 관리` - `사용자` 탭에서 조회할 수 있습니다. 처음에는 기본 계정인 `pi`만 조회가 될 텐데요, 새로운 계정을 추가하기 전에 앞서 공유한 홈 디렉터리 설정을 위해 상단의 `설정` 탭에서 활성화를 해줍니다.

<img src="./images/home_directory.png" style="zoom:80%;" />

다시 `사용자` 탭으로 돌아와서, 저는 별도의 계정을 하나 추가해서 사용할 예정이기 때문에 상단의 `추가` 버튼을 눌러서 아래와 같이 설정했습니다.

<img src="./images/user_add_general.png" style="zoom:80%;" />

`셸`의 경우 일반적으로 사용하는 `/bin/bash`로 변경했고, `그룹`은 `sudo`와 `ssh`를 추가해서 해당 계정으로도 SSH 접근할 수 있도록 설정했습니다. (`users` 그룹은 기본으로 설정되어 있습니다.)

다시 `접근 권한 관리` - `공유 폴더` 탭으로 가서 홈 디렉터리 용도로 추가한 공유 폴더를 선택하고, 상단의 `권한` 버튼을 눌러서 추가한 계정의 권한 설정을 해줍니다.

<img src="./images/user_permission.png" style="zoom:80%;" />



여기까지 NAS 사용을 위한 HDD 및 권한 설정까지 마쳤습니다.

이후에는 설정한 스토리지를 원격으로 접근할 수 있도록 해주는 여러가지 프로토콜들에 대해 알아보겠습니다.